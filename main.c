////////////////////////////////////////////////////////////////////////////////
//
// main.c - Easy Triple-DES
// Copyright (C) 2009  Mehter Tariq <mehtertariq@integramicro.com>
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.
//
////////////////////////////////////////////////////////////////////////////////

#include <stdio.h>
#include <stdlib.h>

#include "tdes.h"

#define _MAIN_H_
#include "main.h"

/* ---------------------------- MR ONE --------------------------------------- */

//using different key to decrypt cipher should NOT equal original plaintext
void test_one_one(FILE* f) {
	fprintf(f, "\r\n------Testing MR 1.1------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08},
			{0xaa, 0xcc, 0xff, 0x0c, 0x01, 0x01, 0x01, 0x2b},
			{0xab, 0x00, 0x01, 0x01, 0x01, 0x7e, 0x3f, 0x1a}
	};
	tdes_init(key_ring);
	fprintf(f, "\r\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	fprintf(f, "\r\nDecrypting 24 bytes of binary data\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	fprintf(f, "\r\nSecond plaintext\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//test a key similar to the real key with front ASCII value changed, should not be same
void test_one_two(FILE* f) {
	fprintf(f, "\r\n------Testing MR 1.2------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x10, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "\r\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	fprintf(f, "\r\nDecrypting 24 bytes of binary data\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	fprintf(f, "\r\nSecond plaintext\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//test a key similar to the real key with front ASCII value increased by 1, should not be same
void test_one_three(FILE* f) {
	fprintf(f, "\r\n------Testing MR 1.3------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x02, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "\r\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	fprintf(f, "\r\nDecrypting 24 bytes of binary data\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	fprintf(f, "\r\nSecond plaintext\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//test a key similar to the real key with back ASCII value changed, should not be same
void test_one_four(FILE* f) {
	fprintf(f, "\r\n------Testing MR 1.4------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x10}
	};
	tdes_init(key_ring);
	fprintf(f, "\r\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	fprintf(f, "\r\nDecrypting 24 bytes of binary data\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	fprintf(f, "\r\nSecond plaintext\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//test a key similar to the real key with back ASCII value increased by 1, should not be same
void test_one_five(FILE* f) {
	fprintf(f, "\r\n------Testing MR 1.5------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x02}
	};
	tdes_init(key_ring);
	fprintf(f, "\r\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	fprintf(f, "\r\nDecrypting 24 bytes of binary data\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	fprintf(f, "\r\nSecond plaintext\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//repeat 1.1 with a different plaintext
void test_one_six(FILE* f) {
	fprintf(f, "\r\n------Testing MR 1.6------\r\n\r\n");
	unsigned char plain_text[32]={0x91, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x00,
			0xAA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x00, 0x01, 0x02, 0x03, 0x04, 0x40, 0x30, 0x20},
			{0xAF, 0xAA, 0xFF, 0x01, 0x01, 0x01, 0x00, 0x10},
			{0xBB, 0xCB, 0xCA, 0xAE, 0xEE, 0x01, 0xDD, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "\r\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	fprintf(f, "\r\nDecrypting 24 bytes of binary data\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	fprintf(f, "\r\nSecond plaintext\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//repeat 1.2 with a different plaintext
void test_one_seven(FILE* f) {
	fprintf(f, "\r\n------Testing MR 1.7------\r\n\r\n");
	unsigned char plain_text[32]={0x91, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x00,
			0xAA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x10, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "\r\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	fprintf(f, "\r\nDecrypting 24 bytes of binary data\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	fprintf(f, "\r\nSecond plaintext\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//repeat 1.3 with a different plaintext
void test_one_eight(FILE* f) {
	fprintf(f, "\r\n------Testing MR 1.8------\r\n\r\n");
	unsigned char plain_text[32]={0x91, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x00,
			0xAA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x02, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "\r\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	fprintf(f, "\r\nDecrypting 24 bytes of binary data\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	fprintf(f, "\r\nSecond plaintext\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//repeat 1.4 with a different plaintext
void test_one_nine(FILE* f) {
	fprintf(f, "\r\n------Testing MR 1.9------\r\n\r\n");
	unsigned char plain_text[32]={0x91, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x00,
			0xAA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x10}
	};
	tdes_init(key_ring);
	fprintf(f, "\r\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	fprintf(f, "\r\nDecrypting 24 bytes of binary data\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	fprintf(f, "\r\nSecond plaintext\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//repeat 1.5 with a different plaintext
void test_one_ten(FILE* f) {
	fprintf(f, "\r\n------Testing MR 1.10------\r\n\r\n");
	unsigned char plain_text[32]={0x91, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x00,
			0xAA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x02}
	};
	tdes_init(key_ring);
	fprintf(f, "\r\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	fprintf(f, "\r\nDecrypting 24 bytes of binary data\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	fprintf(f, "\r\nSecond plaintext\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

/* ---------------------------- MR TWO --------------------------------------- */

//tests that two slightly different plaintexts don't generate similar cipher - this does due to similar blocks
void test_two_one(FILE* f) {
	fprintf(f, "\r\n------Testing MR 2.1------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char plain_text2[32]={0x81, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "Encrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_encrypt(18, plain_text2, encrypted_text);
}

//same as first but decreased
void test_two_two(FILE* f) {
	fprintf(f, "\r\n------Testing MR 2.2------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char plain_text2[32]={0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "Encrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_encrypt(18, plain_text2, encrypted_text);
}

/* ---------------------------- MR THREE --------------------------------------- */

//using different key to encrypt same plaintext should not result in same ciphertext
void test_three_one(FILE* f) {
	fprintf(f, "\r\n------Testing MR 3.1------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x00, 0x01, 0x02, 0x03, 0x04, 0x40, 0x30, 0x20},
			{0xAF, 0xAA, 0xFF, 0x01, 0x01, 0x01, 0x00, 0x10},
			{0xBB, 0xCB, 0xCA, 0xAE, 0xEE, 0x01, 0xDD, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "Encrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_encrypt(18, plain_text, encrypted_text);
}

//test a key similar to the real key with front ASCII value different, should not be same
void test_three_two(FILE* f) {
	fprintf(f, "\r\n------Testing MR 3.2------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x10, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "Encrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_encrypt(18, plain_text, encrypted_text);
}

//test a key similar to the real key with front ASCII value increased by 1, should not be same
void test_three_three(FILE* f) {
	fprintf(f, "\r\n------Testing MR 3.3------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x02, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "Encrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_encrypt(18, plain_text, encrypted_text);
}

//test a key similar to the real key with back ASCII value different, should not be same
void test_three_four(FILE* f) {
	fprintf(f, "\r\n------Testing MR 3.4------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x10}
	};
	tdes_init(key_ring);
	fprintf(f, "Encrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_encrypt(18, plain_text, encrypted_text);
}

//test a key similar to the real key with back ASCII value increased by 1, should not be same
void test_three_five(FILE* f) {
	fprintf(f, "\r\n------Testing MR 3.5------\r\n\r\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x02}
	};
	tdes_init(key_ring);
	fprintf(f, "Encrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_encrypt(18, plain_text, encrypted_text);
}

//generate and encrypt random string, use different key to decrypt, and make sure they are not equal
void test_three_six(FILE* f) {
	fprintf(f, "\r\n------Testing MR 3.6------\r\n\r\n");
	unsigned char plain_text[32]={0x93, 0x01, 0x02, 0x03, 0x04, 0x05, 0x55, 0x07,
			0x1F, 0x2A, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x30,
			0xFA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x00, 0x01, 0x02, 0x03, 0x04, 0x40, 0x30, 0x20},
			{0xAF, 0xAA, 0xFF, 0x01, 0x01, 0x01, 0x00, 0x10},
			{0xBB, 0xCB, 0xCA, 0xAE, 0xEE, 0x01, 0xDD, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "Encrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_decrypt(24, encrypted_text, plain_text);
}

//do everything correctly, then run tests
int main(void) {
	FILE *f = fopen("output.txt", "w");
	if (f == NULL)
	{
		printf("Error opening file!\n");
		exit(1);
	}
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	fprintf(f, "Encrypting 18 bytes of binary data to generate 24 bytes of binary data\r\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	fprintf(f, "Decrypting 24 bytes of binary data\r\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	test_one_one(f);
	test_one_two(f);
	test_one_three(f);
	test_one_four(f);
	test_one_five(f);
	test_one_six(f);
	test_one_seven(f);
	test_one_eight(f);
	test_one_nine(f);
	test_one_ten(f);
	test_two_one(f);
	test_two_two(f);

	/* test_two_three();
	test_two_four();
	test_two_five();
	test_two_six();
	test_two_seven();
	test_two_eight();
	test_two_nine();
	test_two_ten(); */

	test_three_one(f);
	test_three_two(f);
	test_three_three(f);
	test_three_four(f);
	test_three_five(f);
	test_three_six(f);

	/* test_three_seven();
	test_three_eight();
	test_three_nine();
	test_three_ten(); */

	return 0;
}



//NEED TO PASS FILE POINTER TO TDES.C NEXT TO PRINT TO OUTPUT.TXT, THEN PROCESS WITH JAVA OR PYTHON PROGRAM


