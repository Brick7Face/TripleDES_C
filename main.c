////////////////////////////////////////////////////////////////////////////////
//
// main.c - Easy Triple-DES
// Copyright (C) 2009  Mehter Tariq <mehtertariq@integramicro.com>
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.
//
////////////////////////////////////////////////////////////////////////////////

#include <stdio.h>

#include "tdes.h"

#define _MAIN_H_
#include "main.h"

/* ---------------------------- MR ONE --------------------------------------- */

//using different key to decrypt cipher should NOT equal original plaintext
void test_one_one(void) {
	printf("\n------Testing MR 1.1------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08},
			{0xaa, 0xcc, 0xff, 0x0c, 0x01, 0x01, 0x01, 0x2b},
			{0xab, 0x00, 0x01, 0x01, 0x01, 0x7e, 0x3f, 0x1a}
	};
	tdes_init(key_ring);
	printf("\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	printf("\nDecrypting 24 bytes of binary data\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	printf("\nSecond plaintext\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//test a key similar to the real key with front ASCII value changed, should not be same -- FLAG
void test_one_two(void) {
	printf("\n------Testing MR 1.2------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x10, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	printf("\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	printf("\nDecrypting 24 bytes of binary data\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	printf("\nSecond plaintext\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//test a key similar to the real key with front ASCII value increased by 1, should not be same
void test_one_three(void) {
	printf("\n------Testing MR 1.3------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x02, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	printf("\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	printf("\nDecrypting 24 bytes of binary data\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	printf("\nSecond plaintext\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//test a key similar to the real key with back ASCII value changed, should not be same -- FLAG
void test_one_four(void) {
	printf("\n------Testing MR 1.4------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x10}
	};
	tdes_init(key_ring);
	printf("\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	printf("\nDecrypting 24 bytes of binary data\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	printf("\nSecond plaintext\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//test a key similar to the real key with back ASCII value increased by 1, should not be same
void test_one_five(void) {
	printf("\n------Testing MR 1.5------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x02}
	};
	tdes_init(key_ring);
	printf("\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	printf("\nDecrypting 24 bytes of binary data\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	printf("\nSecond plaintext\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//repeat 1.1 with a different plaintext
void test_one_six(void) {
	printf("\n------Testing MR 1.6------\n\n");
	unsigned char plain_text[32]={0x91, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x00,
			0xAA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x00, 0x01, 0x02, 0x03, 0x04, 0x40, 0x30, 0x20},
			{0xAF, 0xAA, 0xFF, 0x01, 0x01, 0x01, 0x00, 0x10},
			{0xBB, 0xCB, 0xCA, 0xAE, 0xEE, 0x01, 0xDD, 0x01}
	};
	tdes_init(key_ring);
	printf("\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	printf("\nDecrypting 24 bytes of binary data\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	printf("\nSecond plaintext\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//repeat 1.2 with a different plaintext
void test_one_seven(void) {
	printf("\n------Testing MR 1.7------\n\n");
	unsigned char plain_text[32]={0x91, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x00,
			0xAA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x10, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	printf("\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	printf("\nDecrypting 24 bytes of binary data\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	printf("\nSecond plaintext\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//repeat 1.3 with a different plaintext
void test_one_eight(void) {
	printf("\n------Testing MR 1.8------\n\n");
	unsigned char plain_text[32]={0x91, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x00,
			0xAA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x02, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	printf("\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	printf("\nDecrypting 24 bytes of binary data\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	printf("\nSecond plaintext\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//repeat 1.4 with a different plaintext
void test_one_nine(void) {
	printf("\n------Testing MR 1.9------\n\n");
	unsigned char plain_text[32]={0x91, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x00,
			0xAA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x10}
	};
	tdes_init(key_ring);
	printf("\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	printf("\nDecrypting 24 bytes of binary data\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	printf("\nSecond plaintext\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

//repeat 1.5 with a different plaintext
void test_one_ten(void) {
	printf("\n------Testing MR 1.10------\n\n");
	unsigned char plain_text[32]={0x91, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x00,
			0xAA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x02}
	};
	tdes_init(key_ring);
	printf("\nEncrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	printf("\nDecrypting 24 bytes of binary data\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	tdes_init(key_ring2);
	printf("\nSecond plaintext\n");
	tdes_decrypt(24, encrypted_text, plain_text);
}

/* ---------------------------- MR TWO --------------------------------------- */

//tests that two slightly different plaintexts don't generate similar cipher - this does due to similar blocks
void test_two_one(void) {
	printf("\n------Testing MR 2.1------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char plain_text2[32]={0x81, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	printf("Encrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_encrypt(18, plain_text2, encrypted_text);
}

//same as first but decreased
void test_two_two(void) {
	printf("\n------Testing MR 2.2------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char plain_text2[32]={0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	printf("Encrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_encrypt(18, plain_text2, encrypted_text);
}

/* ---------------------------- MR THREE --------------------------------------- */

//using different key to encrypt same plaintext should not result in same ciphertext
void test_three_one(void) {
	printf("\n------Testing MR 3.1------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x00, 0x01, 0x02, 0x03, 0x04, 0x40, 0x30, 0x20},
			{0xAF, 0xAA, 0xFF, 0x01, 0x01, 0x01, 0x00, 0x10},
			{0xBB, 0xCB, 0xCA, 0xAE, 0xEE, 0x01, 0xDD, 0x01}
	};
	tdes_init(key_ring);
	printf("Encrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_encrypt(18, plain_text, encrypted_text);
}

//test a key similar to the real key with front ASCII value different, should not be same
void test_three_two(void) {
	printf("\n------Testing MR 3.2------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x10, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	printf("Encrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_encrypt(18, plain_text, encrypted_text);
}

//test a key similar to the real key with front ASCII value increased by 1, should not be same
void test_three_three(void) {
	printf("\n------Testing MR 3.3------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x02, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	printf("Encrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_encrypt(18, plain_text, encrypted_text);
}

//test a key similar to the real key with back ASCII value different, should not be same
void test_three_four(void) {
	printf("\n------Testing MR 3.4------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x10}
	};
	tdes_init(key_ring);
	printf("Encrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_encrypt(18, plain_text, encrypted_text);
}

//test a key similar to the real key with back ASCII value increased by 1, should not be same
void test_three_five(void) {
	printf("\n------Testing MR 3.5------\n\n");
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x02}
	};
	tdes_init(key_ring);
	printf("Encrypting 18 bytes of binary data to generate 24 bytes of binary data\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_encrypt(18, plain_text, encrypted_text);
}

//generate and encrypt random string, use different key to decrypt, and make sure they are not equal
void test_three_six(void) {
	printf("\n------Testing MR 3.6------\n\n");
	unsigned char plain_text[32]={0x93, 0x01, 0x02, 0x03, 0x04, 0x05, 0x55, 0x07,
			0x1F, 0x2A, 0x3D, 0x4C, 0x5B, 0x6A, 0x70, 0x30,
			0xFA, 0xBB};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	unsigned char key_ring2[3][8]={
			{0x00, 0x01, 0x02, 0x03, 0x04, 0x40, 0x30, 0x20},
			{0xAF, 0xAA, 0xFF, 0x01, 0x01, 0x01, 0x00, 0x10},
			{0xBB, 0xCB, 0xCA, 0xAE, 0xEE, 0x01, 0xDD, 0x01}
	};
	tdes_init(key_ring);
	printf("Encrypting 18 bytes of binary data to generate 24 bytes of binary data\n\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	tdes_init(key_ring2);
	tdes_decrypt(24, encrypted_text, plain_text);
}

//do everything correctly, then run tests
int main(void) {
	unsigned char plain_text[32]={0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			0x1A, 0x1B};
	unsigned char encrypted_text[32];
	unsigned char key_ring[3][8]={
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},
			{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01}
	};
	tdes_init(key_ring);
	printf("Encrypting 18 bytes of binary data to generate 24 bytes of binary data\n\n");
	tdes_encrypt(18, plain_text, encrypted_text);
	printf("Decrypting 24 bytes of binary data\n\n");
	tdes_decrypt(24, encrypted_text, plain_text);
	test_one_one();
	test_one_two();
	test_one_three();
	test_one_four();
	test_one_five();
	test_one_six();
	test_one_seven();
	test_one_eight();
	test_one_nine();
	test_one_ten();
	test_two_one();
	test_two_two();

	/* test_two_three();
	test_two_four();
	test_two_five();
	test_two_six();
	test_two_seven();
	test_two_eight();
	test_two_nine();
	test_two_ten(); */

	test_three_one();
	test_three_two();
	test_three_three();
	test_three_four();
	test_three_five();
	test_three_six();

	/* test_three_seven();
	test_three_eight();
	test_three_nine();
	test_three_ten(); */

	return 0;
}
